{"componentChunkName":"component---src-templates-post-template-jsx","path":"/posts/FortiGate-as-Slave-DNS-with-Windows-DNS-Master","result":{"data":{"site":{"siteMetadata":{"title":"Blog by Sam Perrin","subtitle":"Automation Consultant, currently working at Xtravirt. Interested in all things automation/devops related.","copyright":"© All rights reserved.","author":{"name":"Sam Perrin","twitter":"sam_perrin"},"disqusShortname":"","url":"https://samperrin.netlify.com"}},"markdownRemark":{"id":"996b68b7-fd14-5711-9303-dfefce7af8c5","html":"<p>It is possible to setup your FortiGate device so that requests towards specific domains are forwarded to a Windows DNS server. Below are the steps needed to get this working.</p>\n<p><strong>On the Windows Master DNS Server</strong></p>\n<ul>\n<li>Open DNS Manager and open the zone needed</li>\n<li>Find the Start of Authority (SOA) record</li>\n<li>Properties > Zone Transfers</li>\n<li>Allow Zone Transfers > To Any Server (you can also specify the server)</li>\n<li>Open ‘Notify’ and add in the Slave DNS IP address (the IP your FortiGate will be seen as to the Master DNS)</li>\n</ul>\n<p><strong>On the FortiGate Slave</strong></p>\n<ul>\n<li>Enable the DNS Database feature (System > Config > Features)</li>\n<li>\n<p>Go to System > Network > DNS Servers and Create a new DNS Database.</p>\n<ul>\n<li>Type: Slave</li>\n<li>View: Shadow</li>\n<li>DNS Zone:<em>&#x3C;dns_zone></em></li>\n<li>Domain Name:<em>&#x3C;dns_zone.local></em></li>\n<li>IP of Master:</li>\n<li>Authoritative: Enable/Disable</li>\n</ul>\n</li>\n</ul>\n<p><strong>You will then to add an SRV record, as well as identify the source IP address if your Master DNS is over VPN;</strong></p>\n<ul>\n<li>Connect to FortiGate CLI</li>\n<li>Add SRV record</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">config system dns-database\nedit &quot;&lt;dns_zone&gt;&quot;\nset forwarder &quot;&lt;IP of Master DNS&gt;&quot;\nnext\nend</code></pre></div>\n<ul>\n<li>Specify source IP</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">config system dns-database\nedit &quot;&lt;dns_zone&gt;&quot;\nset source-ip &quot;&lt;IP of FortiGate&gt;&quot;\nnext\nend</code></pre></div>\n<p><strong>Add the DNS service to the Interface</strong></p>\n<ul>\n<li>Go to System > Network > DNS Servers and Create a new DNS Service.</li>\n<li>Interface:<em><Interface users will connect to></em></li>\n<li>Mode: Recursive</li>\n</ul>\n<p><strong>Testing</strong></p>\n<p>You can test the new DNS service works by running a ping through your FortiGate CLI</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">execute ping-options source &lt;interface IP address&gt;\nexecute ping &lt;FQDN of a server in the new DNS zone&gt;</code></pre></div>\n<p><strong>Potential Issues</strong></p>\n<p>The interface your users connect to may be set to use the “Same as System DNS”. If you use external DNS servers this means your users will not benefit from the changes we have just made.</p>\n<p>To fix this change the interface settings to be “Same as Interface IP”, this now means users will get the Interface IP as their DNS server, and will benefit from all DNS Database changes we make on the FortiGate</p>","fields":{"tagSlugs":["/tags/other/"],"slug":"/posts/FortiGate-as-Slave-DNS-with-Windows-DNS-Master"},"frontmatter":{"title":"FortiGate as Slave DNS with Windows DNS Master","tags":["other"],"date":"2015-10-24T13:37:45.872Z","description":"Setup your FortiGate device so that requests towards specific domains are forwarded to a Windows DNS server. "}}},"pageContext":{"slug":"/posts/FortiGate-as-Slave-DNS-with-Windows-DNS-Master"}}}